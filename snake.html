<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snake</title>
  <style>
    body {
      background: #222;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
    }
    h1 { margin-bottom: 10px; }
    #game-container {
      position: relative;
      width: 480px;
      height: 480px;
      background: #111;
      border: 4px solid #444;
      box-shadow: 0 0 20px #000a;
      margin-bottom: 20px;
      touch-action: none;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
      background: #222;
    }
    #score {
      font-size: 1.2em;
      margin-bottom: 5px;
    }
    #high-score {
      font-size: 1em;
      margin-bottom: 10px;
      color: #ffd700;
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      grid-template-rows: 1fr 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
      width: 180px;
      justify-items: center;
    }
    .btn {
      background: #444;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 14px 18px;
      font-size: 1.1em;
      cursor: pointer;
      user-select: none;
      transition: background 0.2s;
    }
    .btn:active { background: #666; }
    @media (max-width: 400px) {
      #game-container {
        width: 98vw;
        height: 98vw;
        max-width: 98vw;
        max-height: 98vw;
      }
    }
  </style>
</head>
<body>
  <h1>Snake Game</h1>
  <div id="score">Score: 0</div>
  <div id="high-score">High Score: 0</div>
  <div id="instructions" style="text-align: center; margin-bottom: 10px; font-size: 0.9em; color: #aaa;">
    Use arrow keys (or WASD) to start and control the snake<br>
    On mobile: Use buttons below or swipe on the game area
  </div>
  <div id="game-container">
    <canvas id="game" width="480" height="480"></canvas>
  </div>
  <div class="controls" id="mobile-controls">
    <div></div>
    <button class="btn" id="up">▲</button>
    <div></div>
    <button class="btn" id="left">◀</button>
    <div></div>
    <button class="btn" id="right">▶</button>
    <div></div>
    <button class="btn" id="down">▼</button>
    <div></div>
  </div>
  <div style="text-align: center; margin-top: 20px; font-size: 0.8em; color: #888;">
    Created by Nathan Kalish | <a href="https://github.com/nathanakalish" target="_blank" style="color: #4ecdc4; text-decoration: none;">GitHub</a>
  </div>
  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const box = 20;
    const rows = 24;
    const cols = 24;
    let snake = [{ x: 12, y: 12 }];
    let direction = { x: 0, y: 0 };
    let nextDirection = { x: 0, y: 0 };
    let food = randomFood();
    let score = 0;
    let highScore = parseInt(localStorage.getItem('snakeHighScore')) || 0;
    let gameOver = false;
    let moveInterval = 120;
    let touchStartX = 0, touchStartY = 0;

    function randomFood() {
      let pos;
      do {
        pos = {
          x: Math.floor(Math.random() * cols),
          y: Math.floor(Math.random() * rows)
        };
      } while (snake.some(s => s.x === pos.x && s.y === pos.y));
      return pos;
    }

    function draw() {
      ctx.fillStyle = '#222';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      // Draw food
      ctx.fillStyle = '#e74c3c';
      ctx.fillRect(food.x * box, food.y * box, box, box);
      // Draw snake
      for (let i = 0; i < snake.length; i++) {
        ctx.fillStyle = i === 0 ? '#2ecc40' : '#27ae60';
        ctx.fillRect(snake[i].x * box, snake[i].y * box, box, box);
      }
    }

    function update() {
      if (gameOver) return;
      direction = nextDirection.x !== 0 || nextDirection.y !== 0 ? nextDirection : direction;
      if (direction.x === 0 && direction.y === 0) return; // Not started yet
      const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
      // Wrap around edges
      if (head.x < 0) head.x = cols - 1;
      if (head.x >= cols) head.x = 0;
      if (head.y < 0) head.y = rows - 1;
      if (head.y >= rows) head.y = 0;
      // Self collision
      if (snake.some(s => s.x === head.x && s.y === head.y)) {
        endGame();
        return;
      }
      snake.unshift(head);
      if (head.x === food.x && head.y === food.y) {
        score++;
        document.getElementById('score').textContent = 'Score: ' + score;
        if (score > highScore) {
          highScore = score;
          localStorage.setItem('snakeHighScore', highScore);
          document.getElementById('high-score').textContent = 'High Score: ' + highScore;
        }
        food = randomFood();
      } else {
        snake.pop();
      }
      draw();
    }

    function endGame() {
      gameOver = true;
      ctx.fillStyle = 'rgba(0,0,0,0.7)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#fff';
      ctx.font = '32px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over', canvas.width / 2, canvas.height / 2 - 10);
      ctx.font = '20px Arial';
      ctx.fillText('Score: ' + score, canvas.width / 2, canvas.height / 2 + 24);
      ctx.font = '16px Arial';
      ctx.fillText('Press Space or Tap to Restart', canvas.width / 2, canvas.height / 2 + 50);
    }

    function restart() {
      snake = [{ x: 12, y: 12 }];
      direction = { x: 0, y: 0 };
      nextDirection = { x: 0, y: 0 };
      food = randomFood();
      score = 0;
      gameOver = false;
      document.getElementById('score').textContent = 'Score: 0';
      draw();
    }

    function setDirection(dx, dy) {
      // Prevent reverse
      if (snake.length > 1 && dx === -direction.x && dy === -direction.y) return;
      nextDirection = { x: dx, y: dy };
    }

    // Keyboard controls
    document.addEventListener('keydown', e => {
      if (gameOver && (e.key === ' ' || e.key === 'Enter')) {
        restart();
        return;
      }
      switch (e.key) {
        case 'ArrowUp': case 'w': setDirection(0, -1); break;
        case 'ArrowDown': case 's': setDirection(0, 1); break;
        case 'ArrowLeft': case 'a': setDirection(-1, 0); break;
        case 'ArrowRight': case 'd': setDirection(1, 0); break;
      }
    });

    // Mobile controls
    document.getElementById('up').addEventListener('click', () => setDirection(0, -1));
    document.getElementById('down').addEventListener('click', () => setDirection(0, 1));
    document.getElementById('left').addEventListener('click', () => setDirection(-1, 0));
    document.getElementById('right').addEventListener('click', () => setDirection(1, 0));

    // Touch swipe controls
    document.getElementById('game-container').addEventListener('touchstart', e => {
      if (gameOver) {
        restart();
        return;
      }
      if (e.touches.length === 1) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
      }
    });
    document.getElementById('game-container').addEventListener('touchend', e => {
      if (e.changedTouches.length === 1) {
        const dx = e.changedTouches[0].clientX - touchStartX;
        const dy = e.changedTouches[0].clientY - touchStartY;
        if (Math.abs(dx) > Math.abs(dy)) {
          if (dx > 20) setDirection(1, 0);
          else if (dx < -20) setDirection(-1, 0);
        } else {
          if (dy > 20) setDirection(0, 1);
          else if (dy < -20) setDirection(0, -1);
        }
      }
    });

    // Tap to restart
    document.getElementById('game-container').addEventListener('click', () => {
      if (gameOver) restart();
    });

    // Main game loop
    document.getElementById('high-score').textContent = 'High Score: ' + highScore;
    draw();
    setInterval(update, moveInterval);
  </script>
</body>
</html>